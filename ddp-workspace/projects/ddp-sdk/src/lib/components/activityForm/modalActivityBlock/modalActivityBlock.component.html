<mat-card *ngFor="let instance of block.instances" class="modal-activity-block__card">
  <mat-card-content class="modal-activity-block__card-content">
    <div>
      <mat-card-title class="modal-activity-block__card-title">
        {{instance.activityName}}
      </mat-card-title>
      <mat-card-subtitle *ngIf="instance.activityDescription"
                         class="modal-activity-block__card-subtitle">
        {{instance.activityDescription}}
      </mat-card-subtitle>

      <div *ngIf="instance.statusCode !== 'CREATED'"
           class="modal-activity-block__success-message">
        <mat-icon inline>check_circle</mat-icon>
        <span>{{instance.numQuestionsAnswered}} questions answered</span>
      </div>
    </div>

    <mat-card-actions class="modal-activity-block__card-buttons">
      <button mat-mini-fab
              *ngIf="!instance.readonly"
              class="button_primary"
              (click)="openEditDialog(instance)">
        <img src="assets/images/pencil.svg" alt="Edit">
      </button>
      <button mat-mini-fab
              *ngIf="instance.canDelete"
              #delete_button
              class="button_secondary"
              (click)="openDeleteDialog(instance)">
        <img src="assets/images/trash.svg" alt="Delete">
      </button>
    </mat-card-actions>
  </mat-card-content>
</mat-card>

<ng-template #edit_dialog>
  <div mat-dialog-title class="modal-activity-block__edit-dialog-title">
    <div>{{currentActivityInstance?.activityName}}</div>
    <button mat-icon-button mat-dialog-close class="modal-activity-block__close-button">
      <mat-icon>close</mat-icon>
    </button>
  </div>
  <mat-dialog-content class="modal-activity-block__edit-dialog-content">
    <ddp-activity-section [section]="activityForm?.sections[0]"
                          [readonly]="readonly"
                          [studyGuid]="studyGuid"
                          [activityGuid]="activityGuid"
                          [validationRequested]="validationRequested"
    ></ddp-activity-section>

    <button mat-flat-button
            class="button_primary modal-activity-block__save_activity"
            (click)="closeEditDialog()">
      Save
    </button>
  </mat-dialog-content>
</ng-template>

<ng-template #delete_dialog>
  <div class="modal-activity-block__delete-dialog">
    <span class="modal-activity-block__delete-dialog-title">Are you sure you want to delete\n this information?</span>
    <div class="modal-activity-block__delete-dialog-buttons">
      <button mat-flat-button color="warn" (click)="deleteActivityInstance()">Delete</button>
      <button mat-stroked-button mat-dialog-close>Cancel</button>
    </div>
  </div>
</ng-template>
