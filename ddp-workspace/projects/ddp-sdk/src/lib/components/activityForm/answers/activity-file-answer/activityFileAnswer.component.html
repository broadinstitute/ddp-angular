<!--  TODO: Add i18n  -->
<ddp-question-prompt [block]="block"></ddp-question-prompt>

<div class="file-requirements" *ngIf="fileMaxSize || fileMimeTypes.length">
    <div class="file-max-size" *ngIf="fileMaxSize">Max size: {{fileMaxSize}}</div>
    <div class="file-types" *ngIf="fileMimeTypes.length">Allowed mime-types: {{fileMimeTypes.join(', ')}}</div>
</div>

<div class="file-upload-content" [ngClass]="{'readonly': readonly}">
    <input type="file" class="file-input"
           [accept]="fileMimeTypes.join(',')"
           (change)="onFilesSelected($event.target.files)" #fileUpload>

    <div class="file-select">
        <div class="drop-block"
             dropFileToUpload
             (filesDropped)="!readonly && onFilesSelected($event)">
            <mat-icon class="upload-icon" color="primary">file_upload</mat-icon>
            <span class="drop-block-text">Drag files to upload</span>
        </div>
        <button mat-raised-button color="primary" class="upload-btn"
                [disabled]="readonly"
                (click)="fileUpload.click()">Choose file
            <mat-icon>attach_file</mat-icon>
        </button>

        <div class="selected-file">{{selectedFile?.name}}</div>

        <button *ngIf="!readonly" #uploadBtn
                mat-raised-button color="primary"
                class="submit-btn"
                [disabled]="!isFileSelected"
                (click)="submitFileUpload()">{{uploadedFile?.isUploaded? 'Reupload' : 'Submit'}}
        </button>
    </div>

    <div class="uploaded-file">
        <div class="title">Uploaded:</div>

        <mat-chip-list>
            <mat-chip *ngIf="uploadedFile?.isUploaded"
                      class="uploaded-file-chip"
                      color="primary" selected
                      (removed)="undoUploadedFile()">{{uploadedFile.name}} (size: {{uploadedFile.size}})
                <mat-icon matChipRemove *ngIf="!readonly" #undoUploadBtn>cancel</mat-icon>
            </mat-chip>
        </mat-chip-list>
    </div>
</div>

<ddp-validation-message [message]="errorMessage"></ddp-validation-message>
