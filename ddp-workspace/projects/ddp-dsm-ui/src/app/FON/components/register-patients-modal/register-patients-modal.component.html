<div class="dialogContainer">
  <header>
    <p>Register Patients</p>
  </header>
  <main>
    <section>
      <form [formGroup]="addPatientForm">
        <ng-container formArrayName="patients">
          <ng-container *ngFor="let patient of patients.controls; let i = index">
            <div [formGroup]="patient" [ngClass]="{'hr': i > 0}" class="addPatientForm">

              <div class="patientNav">
                <p class="patientNav-number">Patient {{i + 1}}</p>
                <span *ngIf="i > 0" class="patientNav-remove" (click)="removePatient(i)">X</span>
              </div>

              <div class="input_field">
                <app-input-field
                  label="Email*"
                  placeholder="Enter email address"
                  inputType="text"
                  formControlName="email">
                </app-input-field>
              </div>

              <div class="input_field">
                <app-input-field
                  label="First Name*"
                  placeholder="First name"
                  inputType="text"
                  formControlName="firstName">
                </app-input-field>
                <app-input-field
                  label="Last Name*"
                  placeholder="Last Name"
                  inputType="text"
                  formControlName="lastName">
                </app-input-field>
              </div>

              <div class="input_field">
                <app-input-field
                  label="Date of birth*"
                  placeholder="MM/DD/YY"
                  inputType="date"
                  formControlName="birthDate">
                </app-input-field>
              </div>

              <div class="input_field">
                <app-input-field
                  label="Informed consent date*"
                  placeholder="MM/DD/YY"
                  inputType="date"
                  formControlName="informedConsentDate">
                </app-input-field>
                <app-input-field
                  label="Assent date (if applicable)"
                  placeholder="MM/DD/YY"
                  inputType="date"
                  formControlName="assentDate">
                </app-input-field>
              </div>

            </div>
          </ng-container>
        </ng-container>
        <button class="btn_secondary" (click)="addPatient()" [disabled]="addPatientForm.invalid">
          <mat-icon>add</mat-icon>
          Add another patient
        </button>
      </form>
    </section>
    <aside>
      <div class="fileUpload">
        <p>File upload
          <mat-icon>info</mat-icon>
        </p>
        <div class="fileUpload-dragAndDrop">
          <p>Drag and drop or <br/> <a (click)="file.click()">browse your files</a></p>
          <input type="file" #file style="display: none">
        </div>
      </div>
    </aside>
  </main>
  <footer>
    <button class="btn_secondary" [ngClass]="{'disappear': isAddingPatient}" (click)="closeDialog()">Cancel</button>
    <button class="btn_primary" [disabled]="addPatientForm.invalid || isAddingPatient" (click)="registerPatient()">Register</button>
  </footer>
</div>

<ng-template #successMessage>
  <div class="successMessageContainer">
    <aside>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="50" height="25">
        <path fill="#ffffff" d="M0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256zM371.8 211.8C382.7 200.9 382.7 183.1 371.8 172.2C360.9 161.3 343.1 161.3 332.2 172.2L224 280.4L179.8 236.2C168.9 225.3 151.1 225.3 140.2 236.2C129.3 247.1 129.3 264.9 140.2 275.8L204.2 339.8C215.1 350.7 232.9 350.7 243.8 339.8L371.8 211.8z"/></svg>
    </aside>
    <main>
      <p class="status">Success</p>
      <p class="text" *ngIf="successfullyAddedPatients as SAP">{{SAP + ' new ' + (SAP > 1 ? 'patients' : 'patient') + (SAP > 1 ? ' have' : ' has')}} been registered.</p>
    </main>
  </div>
</ng-template>
